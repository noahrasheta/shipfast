---
phase: 04-synthesis-and-document-output
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - dc-due-diligence-desktop/agents/risk-assessment-agent.md
  - dc-due-diligence-desktop/agents/executive-summary-agent.md
autonomous: true
requirements:
  - SYNTH-01
  - SYNTH-02
  - SYNTH-03
  - SYNTH-05

must_haves:
  truths:
    - "Risk Assessment agent file exists and reads domain reports from research/ using WORKSPACE_FOLDER path convention"
    - "Executive Summary agent file exists with embedded scoring rubric and produces Pursue/Proceed/Pass verdict"
    - "Both agents handle missing domain reports gracefully (score as Low, note gaps)"
    - "Neither agent references PLUGIN_DIR, _converted/, MCP tools, or Python dependencies"
  artifacts:
    - path: "dc-due-diligence-desktop/agents/risk-assessment-agent.md"
      provides: "Cross-domain risk synthesis agent for Cowork"
      contains: "WORKSPACE_FOLDER"
    - path: "dc-due-diligence-desktop/agents/executive-summary-agent.md"
      provides: "Scored executive summary agent with embedded rubric for Cowork"
      contains: "Pursue"
  key_links:
    - from: "dc-due-diligence-desktop/agents/risk-assessment-agent.md"
      to: "research/*-report.md"
      via: "Read tool file access"
      pattern: "WORKSPACE_FOLDER.*research"
    - from: "dc-due-diligence-desktop/agents/executive-summary-agent.md"
      to: "research/risk-assessment-report.md"
      via: "Read tool file access"
      pattern: "risk-assessment-report"
---

<objective>
Port Risk Assessment and Executive Summary agents from CLI to Cowork desktop plugin.

Purpose: These two agents form the core synthesis pipeline (Wave 2 and Wave 3a). Risk Assessment reads all 9 domain reports and identifies cross-cutting risks. Executive Summary reads all 10 reports (9 domain + risk assessment), applies the scoring rubric, and produces the Pursue/Proceed/Pass verdict.

Output: Two agent markdown files in dc-due-diligence-desktop/agents/ ready for orchestrator dispatch.
</objective>

<execution_context>
@/Users/noahrasheta/.claude/get-shit-done/workflows/execute-plan.md
@/Users/noahrasheta/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-synthesis-and-document-output/04-RESEARCH.md
@.planning/phases/04-synthesis-and-document-output/04-CONTEXT.md
@dc-due-diligence/agents/risk-assessment-agent.md
@dc-due-diligence/agents/executive-summary-agent.md
@dc-due-diligence/templates/scoring-rubric.md
@dc-due-diligence-desktop/agents/power-agent.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Port Risk Assessment agent to Cowork</name>
  <files>dc-due-diligence-desktop/agents/risk-assessment-agent.md</files>
  <action>
Port the CLI risk-assessment-agent.md to the Cowork desktop plugin following the Phase 3 adaptation pattern established in Plans 03-01 through 03-03.

**Reference:** Read dc-due-diligence/agents/risk-assessment-agent.md as the source implementation.
**Pattern reference:** Read dc-due-diligence-desktop/agents/power-agent.md to see the established Cowork adaptation pattern.

**Adaptation rules (identical to Phase 3 domain agent porting):**

1. **Keep verbatim:**
   - YAML frontmatter (name, description)
   - Tiered Domain Framework (entire section with Tier 1/2/3 definitions)
   - Analysis Workflow phases (Phase 1-4 complete methodology)
   - Cross-Domain Risk Categories (all 7 categories: Infrastructure Dependency Chains, Timeline Misalignment, Financial Risk Compounding, Verification Gap Analysis, Location-Driven Compound Risks, Ownership & Control Red Flags, Market Position vs. Site Reality)
   - Common Cross-Domain Risk Patterns (all 8 patterns with tier impact analysis)
   - Output Format template (complete report structure with all sections)
   - Confidence Score Calculation methodology
   - Traffic Light Rules (GREEN/YELLOW/RED criteria)
   - Key Reminders (all bullet points)
   - Tier-Based Risk Prioritization and Deal-Breaker Assessment
   - Tier-Driven Overall Risk Assessment with verdict reasoning

2. **Replace:**
   - `${OPPORTUNITY_FOLDER}` -> `${WORKSPACE_FOLDER}` (all occurrences)
   - `${PLUGIN_DIR}/templates/agent-output-template.md` -> Remove reference; the output format is already defined in the agent file itself (the Output Format section IS the template)

3. **Remove:**
   - Any MCP tool references (there should be none in risk assessment -- it does not do web research)

4. **Add "Your Task" section** (matching power-agent.md pattern):
   ```
   ## Your Task

   **Workspace Folder:** `${WORKSPACE_FOLDER}`
   **Research Reports Path:** `${WORKSPACE_FOLDER}/research/`
   **Output Path:** `${WORKSPACE_FOLDER}/research/risk-assessment-report.md`

   1. Read all 9 domain research reports from `${WORKSPACE_FOLDER}/research/` using the Read tool
   2. If a report file does not exist or is empty, note that domain as a gap
   3. Follow the four-phase analysis workflow below
   4. Write your report to `${WORKSPACE_FOLDER}/research/risk-assessment-report.md`
   ```

5. **Update Research Reports to Read section:**
   - Keep all 9 report paths but use `${WORKSPACE_FOLDER}/research/` prefix
   - Keep the instruction "If a report is missing, note the gap"

6. **Do NOT add Document Safety Protocol** -- the Risk Assessment agent reads research reports written by other agents, not broker documents. It does not need prompt injection detection.

7. **Source document count:** Replace any reference to `_converted/manifest.json` with: "Check `${WORKSPACE_FOLDER}/_dd_inventory.json` for the total_files field. If this file does not exist, state 'multiple' instead of a specific count."

The resulting file should be the full CLI risk-assessment-agent.md with only the path convention changes and the added "Your Task" section.
  </action>
  <verify>
grep -c "WORKSPACE_FOLDER" dc-due-diligence-desktop/agents/risk-assessment-agent.md && grep -c "OPPORTUNITY_FOLDER" dc-due-diligence-desktop/agents/risk-assessment-agent.md && grep -c "PLUGIN_DIR" dc-due-diligence-desktop/agents/risk-assessment-agent.md && grep -c "Tiered Domain Framework" dc-due-diligence-desktop/agents/risk-assessment-agent.md && grep -c "Pursue" dc-due-diligence-desktop/agents/risk-assessment-agent.md
  </verify>
  <done>risk-assessment-agent.md exists in dc-due-diligence-desktop/agents/ with WORKSPACE_FOLDER paths, zero OPPORTUNITY_FOLDER references, zero PLUGIN_DIR references, complete tiered framework, and verdict terminology present</done>
</task>

<task type="auto">
  <name>Task 2: Port Executive Summary agent to Cowork with embedded scoring rubric</name>
  <files>dc-due-diligence-desktop/agents/executive-summary-agent.md</files>
  <action>
Port the CLI executive-summary-agent.md to the Cowork desktop plugin with the scoring rubric embedded directly in the agent file.

**Reference:** Read dc-due-diligence/agents/executive-summary-agent.md as the source implementation.
**Reference:** Read dc-due-diligence/templates/scoring-rubric.md for the scoring criteria to embed.

**Adaptation rules:**

1. **Keep verbatim:**
   - YAML frontmatter (name, description)
   - Workflow phases (Phase 1-6 complete methodology)
   - Terminology Normalization map (complete table)
   - Conflict Detection and Resolution rules
   - Key Questions Aggregation methodology (Phase 3.5)
   - Category Scoring methodology (Phase 4)
   - Overall Verdict Determination with tier-based reasoning (Phase 5)
   - Strategic Framing (Phase 5.5)
   - Output Format (complete Executive Summary structure)
   - Opportunity Name Extraction logic
   - Handling Missing Domains rules
   - Writing Style section (complete)
   - Key Reminders (all bullet points)

2. **Replace:**
   - `${OPPORTUNITY_FOLDER}` -> `${WORKSPACE_FOLDER}` (all occurrences)
   - `${PLUGIN_DIR}/templates/scoring-rubric.md` -> Remove reference; embed scoring criteria directly (see below)

3. **Embed scoring rubric:** Instead of referencing the external scoring-rubric.md file, embed the essential scoring content directly in the agent file. Include:
   - Domain Tiers section (Tier 1/2/3 definitions with rationale)
   - Category Scoring Criteria (all 10 categories with High/Medium/Low tables)
   - Overall Verdict Logic (Pursue/Proceed with Caution/Pass rules)
   - Edge Cases and Judgment Calls (all 7 tiebreaker principles)
   - Quick Reference Table
   - Verdict Quick Reference table

   Place the embedded rubric in a clearly marked section: `## Scoring Rubric` after the Workflow section. The agent's Phase 4 instructions should reference "the Scoring Rubric section below" instead of the external file path.

4. **Remove:**
   - MCP tool references (there should be none)
   - Reference to `_converted/manifest.json`

5. **Add "Your Task" section:**
   ```
   ## Your Task

   **Workspace Folder:** `${WORKSPACE_FOLDER}`
   **Research Reports Path:** `${WORKSPACE_FOLDER}/research/`
   **Output Path:** `${WORKSPACE_FOLDER}/EXECUTIVE_SUMMARY.md`

   1. Read all 10 research reports from `${WORKSPACE_FOLDER}/research/` using the Read tool
   2. Read the scoring rubric embedded in this agent file (Scoring Rubric section below)
   3. If a report file does not exist or is empty, score that category as Low per the rubric's missing report rules
   4. Follow the six-phase workflow below
   5. Write your report to `${WORKSPACE_FOLDER}/EXECUTIVE_SUMMARY.md`
   ```

6. **Source document count:** Replace `_converted/manifest.json` reference with: "Check `${WORKSPACE_FOLDER}/_dd_inventory.json` for the total_files field. If this file does not exist, state 'the provided documents' instead of a specific count."

7. **Do NOT add Document Safety Protocol** -- the Executive Summary agent reads research reports, not broker documents.

The resulting file will be large (~70-80KB) due to the embedded scoring rubric. This is acceptable per the research recommendation -- it guarantees the agent always has access to its scoring methodology.
  </action>
  <verify>
grep -c "WORKSPACE_FOLDER" dc-due-diligence-desktop/agents/executive-summary-agent.md && grep -c "OPPORTUNITY_FOLDER" dc-due-diligence-desktop/agents/executive-summary-agent.md && grep -c "PLUGIN_DIR" dc-due-diligence-desktop/agents/executive-summary-agent.md && grep -c "Scoring Rubric" dc-due-diligence-desktop/agents/executive-summary-agent.md && grep -c "Pursue" dc-due-diligence-desktop/agents/executive-summary-agent.md && grep -c "Tier 1" dc-due-diligence-desktop/agents/executive-summary-agent.md
  </verify>
  <done>executive-summary-agent.md exists in dc-due-diligence-desktop/agents/ with WORKSPACE_FOLDER paths, zero OPPORTUNITY_FOLDER references, zero PLUGIN_DIR references, embedded scoring rubric with all 10 category criteria, verdict logic (Pursue/Proceed/Pass), and tier framework present</done>
</task>

</tasks>

<verification>
1. Both agent files exist in dc-due-diligence-desktop/agents/
2. Zero occurrences of OPPORTUNITY_FOLDER in either file
3. Zero occurrences of PLUGIN_DIR in either file
4. Zero occurrences of _converted/manifest.json in either file
5. risk-assessment-agent.md contains: Tiered Domain Framework, Cross-Domain Risk Categories, Traffic Light Rules
6. executive-summary-agent.md contains: embedded Scoring Rubric section, Verdict Determination, Terminology Normalization
7. Both files use ${WORKSPACE_FOLDER} for path references
8. Both files handle missing domain reports gracefully
</verification>

<success_criteria>
- Risk Assessment agent ready for Wave 2 dispatch (reads 9 domain reports, produces cross-domain risk analysis)
- Executive Summary agent ready for Wave 3a dispatch (reads 10 reports, applies scoring rubric, produces verdict)
- Both agents follow established Cowork adaptation pattern from Phase 3
- No external file dependencies (scoring rubric embedded, no template reads)
</success_criteria>

<output>
After completion, create `.planning/phases/04-synthesis-and-document-output/04-01-SUMMARY.md`
</output>
