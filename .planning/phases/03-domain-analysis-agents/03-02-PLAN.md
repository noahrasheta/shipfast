---
phase: 03-domain-analysis-agents
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - dc-due-diligence-desktop/agents/land-zoning-agent.md
  - dc-due-diligence-desktop/agents/ownership-agent.md
  - dc-due-diligence-desktop/agents/environmental-agent.md
  - dc-due-diligence-desktop/agents/commercials-agent.md
autonomous: true
requirements: [DOMAIN-04, DOMAIN-05, DOMAIN-06, DOMAIN-07]

must_haves:
  truths:
    - "Land/Zoning agent file exists and contains zoning compliance, permits, building status, and entitlement extraction categories"
    - "Ownership agent file exists and contains verified owner, owner background, chain of title, and middleman detection categories"
    - "Environmental agent file exists and contains natural hazard, compliance, contamination, and climate resilience categories"
    - "Commercials agent file exists and contains land cost, power cost, lease structure, and financial terms categories"
    - "Each agent reads only from its own domain key in _dd_inventory.json"
    - "Document Safety Protocol appears at the top of every agent file, verbatim from CLI version"
  artifacts:
    - path: "dc-due-diligence-desktop/agents/land-zoning-agent.md"
      provides: "Land/Zoning domain analysis agent for Cowork"
      contains: "Document Safety Protocol"
    - path: "dc-due-diligence-desktop/agents/ownership-agent.md"
      provides: "Ownership domain analysis agent for Cowork"
      contains: "Document Safety Protocol"
    - path: "dc-due-diligence-desktop/agents/environmental-agent.md"
      provides: "Environmental domain analysis agent for Cowork"
      contains: "Document Safety Protocol"
    - path: "dc-due-diligence-desktop/agents/commercials-agent.md"
      provides: "Commercials domain analysis agent for Cowork"
      contains: "Document Safety Protocol"
  key_links:
    - from: "dc-due-diligence-desktop/agents/land-zoning-agent.md"
      to: "_dd_inventory.json"
      via: "Agent reads domains.land-zoning.files[] from inventory"
      pattern: "domains\\.land-zoning\\.files"
    - from: "dc-due-diligence-desktop/agents/ownership-agent.md"
      to: "_dd_inventory.json"
      via: "Agent reads domains.ownership.files[] from inventory"
      pattern: "domains\\.ownership\\.files"
    - from: "dc-due-diligence-desktop/agents/environmental-agent.md"
      to: "_dd_inventory.json"
      via: "Agent reads domains.environmental.files[] from inventory"
      pattern: "domains\\.environmental\\.files"
    - from: "dc-due-diligence-desktop/agents/commercials-agent.md"
      to: "_dd_inventory.json"
      via: "Agent reads domains.commercials.files[] from inventory"
      pattern: "domains\\.commercials\\.files"
---

<objective>
Port Land/Zoning, Ownership, Environmental, and Commercials agents from CLI to Cowork format using the exact same adaptation pattern established by Plan 01.

Purpose: Bulk porting of 4 domain agents following the proven pattern from Plan 01. No new orchestrator logic needed — dispatch already handles all 9 domains.
Output: 4 agent files in dc-due-diligence-desktop/agents/
</objective>

<execution_context>
@/Users/noahrasheta/.claude/get-shit-done/workflows/execute-plan.md
@/Users/noahrasheta/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-domain-analysis-agents/03-CONTEXT.md
@.planning/phases/03-domain-analysis-agents/03-RESEARCH.md

# CLI reference agents (read these to port methodology)
@dc-due-diligence/agents/land-zoning-agent.md
@dc-due-diligence/agents/ownership-agent.md
@dc-due-diligence/agents/environmental-agent.md
@dc-due-diligence/agents/commercials-agent.md

# Report template (agents must follow this output format)
@dc-due-diligence/templates/agent-output-template.md

# Pattern reference — use Plan 01 agents as the Cowork adaptation model
@dc-due-diligence-desktop/agents/power-agent.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Land/Zoning and Ownership agent files</name>
  <files>
    dc-due-diligence-desktop/agents/land-zoning-agent.md
    dc-due-diligence-desktop/agents/ownership-agent.md
  </files>
  <action>
Create two agent files following the exact same adaptation pattern used for the Power agent in Plan 01. For each agent, read the CLI reference at `dc-due-diligence/agents/{domain}-agent.md` AND read the already-created `dc-due-diligence-desktop/agents/power-agent.md` as the structural model for the Cowork adaptation.

**Apply the same adaptation rules as Plan 01 Task 1:**
- Keep verbatim: YAML frontmatter, Document Safety Protocol (before "Your Task"), two-phase workflow, extraction categories, verification sources, verification status tags, confidence scoring, traffic light rules, key reminders, terminology normalization, key questions instructions
- Replace: `${OPPORTUNITY_FOLDER}` with `${WORKSPACE_FOLDER}`, `_converted/` with inventory JSON reading, plugin path template reference with inline section list
- Remove: All MCP tool references (ToolSearch, Firecrawl, Exa, Tavily), "Enhanced tools" section, `_converted/` references
- Add: Inventory-based "Your Task" section, context budget guidance (50 pages for large docs), explicit "read ONLY assigned files" instruction

**Domain-specific details:**
- land-zoning-agent.md: `domains.land-zoning.files[]`, output: `research/land-zoning-report.md`
- ownership-agent.md: `domains.ownership.files[]`, output: `research/ownership-report.md`

**Match the structural order from the power-agent.md Cowork version** — use it as your template for section ordering.
  </action>
  <verify>
    <automated>
cd /Users/noahrasheta/Dev/GitHub/shipfast && \
for agent in land-zoning ownership; do \
  FILE="dc-due-diligence-desktop/agents/${agent}-agent.md"; \
  echo "=== $agent ===" && \
  test -f "$FILE" && echo "EXISTS: yes" || echo "EXISTS: NO" && \
  head -3 "$FILE" | grep -q "^---" && echo "FRONTMATTER: yes" || echo "FRONTMATTER: NO" && \
  grep -q "Document Safety Protocol" "$FILE" && echo "SAFETY: yes" || echo "SAFETY: NO" && \
  grep -q "_dd_inventory.json" "$FILE" && echo "INVENTORY_REF: yes" || echo "INVENTORY_REF: NO" && \
  grep -q "WORKSPACE_FOLDER" "$FILE" && echo "WORKSPACE_VAR: yes" || echo "WORKSPACE_VAR: NO" && \
  (grep -q "_converted" "$FILE" && echo "CONVERTED_REF: FAIL" || echo "NO_CONVERTED: yes") && \
  (grep -qi "ToolSearch\|firecrawl\|tavily\|exa" "$FILE" && echo "MCP_REF: FAIL" || echo "NO_MCP: yes"); \
done
    </automated>
  </verify>
  <done>
land-zoning-agent.md and ownership-agent.md exist in dc-due-diligence-desktop/agents/ with complete Cowork adaptation: YAML frontmatter, Document Safety Protocol, two-phase workflow, inventory-based file reading, no legacy references.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Environmental and Commercials agent files</name>
  <files>
    dc-due-diligence-desktop/agents/environmental-agent.md
    dc-due-diligence-desktop/agents/commercials-agent.md
  </files>
  <action>
Create two more agent files following the identical adaptation pattern. Read the CLI references and the power-agent.md Cowork version as the structural model.

**Apply the same adaptation rules as Plan 01 Task 1** (same keep/replace/remove/add list).

**Domain-specific details:**
- environmental-agent.md: `domains.environmental.files[]`, output: `research/environmental-report.md`
- commercials-agent.md: `domains.commercials.files[]`, output: `research/commercials-report.md`

**Special note for Commercials agent:** The CLI commercials agent (422 lines) is one of the larger agents. Ensure the full extraction categories (Land Cost, Power Cost, Lease Structure, Financial Terms) and their keyword lists are preserved. The commercials domain has significant overlap potential with other domains — the agent prompt must emphasize analyzing ONLY financial/commercial aspects, not power pricing (that's the Power agent's job) or land acquisition (that's the Land/Zoning agent's job).

**Special note for Environmental agent:** The CLI environmental agent includes FEMA flood zone lookups and EPA database queries as verification sources. These should be preserved as WebSearch queries (they're publicly accessible web content), but remove any MCP-specific tool calls.
  </action>
  <verify>
    <automated>
cd /Users/noahrasheta/Dev/GitHub/shipfast && \
for agent in environmental commercials; do \
  FILE="dc-due-diligence-desktop/agents/${agent}-agent.md"; \
  echo "=== $agent ===" && \
  test -f "$FILE" && echo "EXISTS: yes" || echo "EXISTS: NO" && \
  head -3 "$FILE" | grep -q "^---" && echo "FRONTMATTER: yes" || echo "FRONTMATTER: NO" && \
  grep -q "Document Safety Protocol" "$FILE" && echo "SAFETY: yes" || echo "SAFETY: NO" && \
  grep -q "_dd_inventory.json" "$FILE" && echo "INVENTORY_REF: yes" || echo "INVENTORY_REF: NO" && \
  grep -q "WORKSPACE_FOLDER" "$FILE" && echo "WORKSPACE_VAR: yes" || echo "WORKSPACE_VAR: NO" && \
  (grep -q "_converted" "$FILE" && echo "CONVERTED_REF: FAIL" || echo "NO_CONVERTED: yes") && \
  (grep -qi "ToolSearch\|firecrawl\|tavily\|exa" "$FILE" && echo "MCP_REF: FAIL" || echo "NO_MCP: yes"); \
done
    </automated>
  </verify>
  <done>
environmental-agent.md and commercials-agent.md exist in dc-due-diligence-desktop/agents/ with complete Cowork adaptation: YAML frontmatter, Document Safety Protocol, two-phase workflow, inventory-based file reading, no legacy references.
  </done>
</task>

</tasks>

<verification>
All 4 agent files exist and pass the same structural checks as Plan 01 agents:
1. YAML frontmatter with name and description
2. Document Safety Protocol verbatim from CLI, positioned before "Your Task"
3. Inventory-based file reading (domains.{key}.files[])
4. No _converted/ or MCP tool references
5. Report output paths match expected pattern
</verification>

<success_criteria>
- 4 agent files created: land-zoning-agent.md, ownership-agent.md, environmental-agent.md, commercials-agent.md
- Each agent structurally mirrors the power-agent.md Cowork version from Plan 01
- No file conflicts with Plan 01 (different files entirely)
- Validation script passes clean for all 4 agents
</success_criteria>

<output>
After completion, create `.planning/phases/03-domain-analysis-agents/03-02-SUMMARY.md`
</output>
