# Codebase Structure

**Analysis Date:** 2026-02-23

## Directory Layout

```
shipfast/
├── .claude-plugin/
│   └── marketplace.json              # Marketplace catalog (lists all installable plugins)
├── .claude/                          # Claude Code local runtime data
├── .planning/                        # Documentation generated by GSD planning tools
├── .github/                          # GitHub Actions workflows (if any)
├── .git/                             # Git repository metadata
├── .director/                        # Director agent/workflow data
├── CLAUDE.md                         # Project instructions for Claude (this repo's conventions)
├── README.md                         # Public-facing documentation
├── LICENSE                           # MIT license
├── create-image/                     # Plugin 1: AI image generation via PaperBanana
│   ├── .claude-plugin/
│   │   └── plugin.json               # Plugin manifest (name, version, author, description)
│   ├── agents/                       # 4 specialized agents (sequential pipeline)
│   │   ├── research-agent.md         # Analyzes reference images, produces style brief
│   │   ├── prompt-architect.md       # Transforms style brief into 5 variant prompts
│   │   ├── generator-agent.md        # Calls Gemini API to generate 5 image variants
│   │   └── critic-agent.md           # Scores and ranks generated images
│   ├── skills/
│   │   └── create-image/
│   │       └── SKILL.md              # Orchestrator skill (main entry point)
│   ├── references/
│   │   ├── gemini-api-guide.md       # API reference for Nano Banana Pro
│   │   └── paperbanana-insights.md   # Research paper insights
│   ├── scripts/
│   │   └── generate-image.py         # Python helper to call Gemini API
│   ├── temp/                         # Development/testing artifacts (not committed)
│   └── README.md                     # Plugin documentation
├── dc-due-diligence/                 # Plugin 2: Data center due diligence analysis
│   ├── .claude-plugin/
│   │   └── plugin.json               # Plugin manifest
│   ├── agents/                       # 12 specialized agents (Wave 1-4 execution)
│   │   ├── power-agent.md            # Electrical infrastructure analysis
│   │   ├── connectivity-agent.md     # Fiber and network routing analysis
│   │   ├── water-cooling-agent.md    # Water supply and cooling system analysis
│   │   ├── land-zoning-agent.md      # Zoning compliance and entitlements
│   │   ├── ownership-agent.md        # Property ownership verification
│   │   ├── environmental-agent.md    # Natural hazards and contamination
│   │   ├── commercials-agent.md      # Deal terms and financial analysis
│   │   ├── natural-gas-agent.md      # Natural gas pipeline and generation
│   │   ├── market-comparables-agent.md # Comparable transactions analysis
│   │   ├── risk-assessment-agent.md  # Cross-domain risk synthesis (Wave 2)
│   │   ├── executive-summary-agent.md # Scoring and verdict generation (Wave 3)
│   │   ├── client-summary-agent.md   # External deliverable generation (Wave 4)
│   │   └── test-agent.md             # Development/testing agent
│   ├── skills/
│   │   └── due-diligence/
│   │       └── SKILL.md              # Orchestrator skill (main entry point)
│   ├── converters/                   # Document processing pipeline (Python)
│   │   ├── __init__.py               # Package exports (converter classes and utilities)
│   │   ├── base.py                   # BaseConverter interface, ExtractionResult, ConfidenceLevel
│   │   ├── pdf.py                    # PDFConverter (pdfplumber for text PDFs)
│   │   ├── vision.py                 # VisionConverter (Claude vision API for scanned/images)
│   │   ├── excel.py                  # ExcelConverter (openpyxl for spreadsheets)
│   │   ├── word.py                   # WordConverter (python-docx for Word docs)
│   │   ├── powerpoint.py             # PowerPointConverter (python-pptx for presentations)
│   │   ├── scanner.py                # FileScanner (folder scanning and type detection)
│   │   ├── pipeline.py               # Main orchestrator: scan → convert → aggregate
│   │   └── generate_pdf.py           # PDF rendering: markdown → PDF conversion
│   ├── templates/                    # Standardized output templates and rubrics
│   │   ├── agent-output-template.md  # Required structure for domain research reports
│   │   ├── client-summary-template.md # External deliverable structure
│   │   ├── scoring-rubric.md         # Scoring criteria (High/Medium/Low tiers)
│   │   └── pdf-styles/               # CSS/styling for PDF rendering
│   ├── tests/                        # Test suite (pytest)
│   │   ├── __pycache__/
│   │   └── [test files]
│   ├── pyproject.toml                # Python package metadata, dependencies, test config
│   ├── setup.sh                      # Bash script to initialize Python venv
│   └── README.md                     # Plugin documentation
```

## Directory Purposes

**`.claude-plugin/`:**
- Purpose: Plugin registry and marketplace metadata
- Contains: `marketplace.json` listing all plugins with name, source path, and description
- Key files: `marketplace.json` (root-level, plugin index)

**`create-image/`:**
- Purpose: Self-contained plugin for AI image generation
- Contains: 4 agents (research → prompt-architect → generator → critic), skill orchestrator, Gemini API helpers
- Key pattern: Sequential agent pipeline; no document conversion needed (direct API calls)

**`dc-due-diligence/`:**
- Purpose: Self-contained plugin for data center site analysis
- Contains: 12 agents (9 domain + risk assessment + executive summary + client summary), skill orchestrator, Python document converters, templates, tests
- Key pattern: Parallel Wave 1 agents, then sequential Waves 2-4; heavy document processing pipeline

**`agents/` (per plugin):**
- Purpose: Collection of specialized agents implementing domain logic
- Contains: `.md` files with YAML frontmatter (name, description, tools) and markdown instructions
- Convention: One file per agent; file name matches agent name (e.g., `power-agent.md`)

**`skills/<skill-name>/` (per plugin):**
- Purpose: Orchestrator skill (single skill per plugin, acts as CLI entry point)
- Contains: `SKILL.md` with YAML frontmatter (name, description) and detailed orchestration instructions
- Convention: Directory-based format; always named SKILL.md (not flat filename)

**`converters/` (dc-due-diligence only):**
- Purpose: Python document processing pipeline
- Contains: File type-specific converters, scanner for file detection, pipeline orchestrator, PDF generation
- Pattern: Each converter class inherits from `BaseConverter`, implements `convert()` method, returns `ExtractionResult`

**`templates/` (dc-due-diligence only):**
- Purpose: Standardized output structures and evaluation rubrics
- Contains: Markdown templates for agent outputs, scoring rubrics, PDF styling
- Files:
  - `agent-output-template.md` — required sections: Executive Summary, Findings, Risks, Recommendations, Research Methodology
  - `scoring-rubric.md` — tier definitions and scoring criteria
  - `client-summary-template.md` — external deliverable structure (no internal scoring language)

**`references/` (create-image only):**
- Purpose: Domain knowledge and API reference for agents
- Contains: Gemini API guide, PaperBanana research insights
- Used by: Agents via `${CLAUDE_PLUGIN_ROOT}/references/*` references

**`scripts/` (per plugin):**
- Purpose: Utility Python scripts (Gemini image generation, PDF rendering, etc.)
- Contains: Helper functions and subprocess-callable modules

**`tests/` (dc-due-diligence only):**
- Purpose: Test suite using pytest
- Contains: Test files validating converters and pipeline logic
- Config: `pyproject.toml` specifies testpaths and dependencies

## Key File Locations

**Entry Points:**
- `create-image/skills/create-image/SKILL.md` — Main orchestrator for `/create-image` command
- `dc-due-diligence/skills/due-diligence/SKILL.md` — Main orchestrator for `/due-diligence` command
- `.claude-plugin/marketplace.json` — Plugin registry accessible via `/plugin marketplace add`

**Configuration:**
- `.claude-plugin/marketplace.json` — Lists plugins, source paths, descriptions (root-level catalog)
- `create-image/.claude-plugin/plugin.json` — Plugin v0.1.0 metadata
- `dc-due-diligence/.claude-plugin/plugin.json` — Plugin v0.2.1 metadata
- `dc-due-diligence/pyproject.toml` — Python package config, dependencies, test paths

**Core Logic:**
- `create-image/agents/*.md` — 4 sequential agents
- `dc-due-diligence/agents/*.md` — 12 domain + synthesis agents
- `dc-due-diligence/converters/pipeline.py` — Document processing orchestrator
- `dc-due-diligence/converters/base.py` — Converter interface and data models

**Utilities & References:**
- `create-image/scripts/generate-image.py` — Gemini API caller
- `dc-due-diligence/converters/generate_pdf.py` — Markdown-to-PDF converter
- `create-image/references/paperbanana-insights.md` — Research framework reference
- `dc-due-diligence/templates/scoring-rubric.md` — Evaluation criteria

## Naming Conventions

**Files:**
- Agent files: `<domain>-agent.md` (e.g., `power-agent.md`, `research-agent.md`)
- Skill files: `SKILL.md` (always uppercase, always in `skills/<name>/` directory)
- Plugin manifests: `plugin.json` (always in `.claude-plugin/` subdirectory)
- Converter modules: `<format>.py` (e.g., `pdf.py`, `excel.py`, `vision.py`)
- Output reports: `<domain>-report.md` (e.g., `power-report.md`, `risk-assessment-report.md`)
- Summary documents: `EXECUTIVE_SUMMARY.md`, `CLIENT_SUMMARY.md`

**Directories:**
- Plugin directories: lowercase hyphenated names (e.g., `create-image`, `dc-due-diligence`)
- Agent collection: `agents/` (always lowercase, plural)
- Skill collection: `skills/<skill-name>/` (directory per skill, contains SKILL.md)
- Converter module: `converters/` (package directory)
- Output folder (create-image): `shipfast-images/` (lowercase hyphenated)
- Converted documents: `_converted/` (leading underscore to denote generated, not committed)
- Research reports: `research/` (where domain agents write outputs)

**Variables & References:**
- Environment variables: UPPERCASE_SNAKE_CASE (`GEMINI_API_KEY`, `ANTHROPIC_API_KEY`)
- Python constants: UPPERCASE_SNAKE_CASE (`CONVERTED_DIR_NAME`, `MANIFEST_FILENAME`)
- Path placeholders in agent instructions: `${CLAUDE_PLUGIN_ROOT}`, `${OPPORTUNITY_FOLDER}`, `${ARGUMENTS}`

## Where to Add New Code

**New Agent (within plugin):**
- File: `<plugin>/agents/<name>-agent.md`
- Template: YAML frontmatter with name, description, tools; markdown instructions
- Follow pattern from existing agents (e.g., `power-agent.md`)
- Register in skill orchestrator by adding Task tool spawn call

**New Converter (dc-due-diligence):**
- File: `dc-due-diligence/converters/<format>.py`
- Inherit from `BaseConverter` (see `base.py`)
- Implement `convert()` method returning `ExtractionResult`
- Register in `scanner.py` FileType enum and converter dispatch logic
- Add to `__init__.py` exports

**New Plugin (at repo root):**
1. Create directory: `/new-plugin/`
2. Add plugin manifest: `/new-plugin/.claude-plugin/plugin.json`
3. Add skill: `/new-plugin/skills/<skill-name>/SKILL.md`
4. Add agents: `/new-plugin/agents/*.md`
5. Register in `.claude-plugin/marketplace.json` (add plugin entry with name, source, description)
6. Update `CLAUDE.md` with plugin reference section (explaining what it does, how to use, output)
7. Update `README.md` with plugin row in table and detailed section

**New Template (dc-due-diligence):**
- File: `dc-due-diligence/templates/<purpose>.md`
- Purpose: Standardized structure agents should follow
- Reference from agents via `${CLAUDE_PLUGIN_ROOT}/templates/<filename>`

**New Utility Script:**
- File: `<plugin>/scripts/<purpose>.py`
- Purpose: Subprocess-callable helpers (API calls, data processing)
- Invoked from orchestrator via bash subprocess or from agents via file system

**New Test (dc-due-diligence):**
- File: `dc-due-diligence/tests/test_<module>.py`
- Framework: pytest
- Run: `pytest` or `pytest tests/test_<module>.py` in project root
- Config: Defined in `pyproject.toml` [tool.pytest.ini_options]

## Special Directories

**`_converted/` (generated, dc-due-diligence):**
- Purpose: Staging area for converted documents during pipeline execution
- Generated: Yes (created by `converters/pipeline.py`)
- Committed: No (in .gitignore)
- Contents: Markdown versions of broker documents + `manifest.json` tracking conversion success/confidence

**`.venv/` (generated, dc-due-diligence):**
- Purpose: Python virtual environment for converter dependencies
- Generated: Yes (created by `setup.sh` on first run)
- Committed: No (in .gitignore)
- Contents: Python interpreter + installed packages from `pyproject.toml`

**`shipfast-images/` (generated, create-image):**
- Purpose: Output folder for generated images
- Generated: Yes (created by orchestrator during setup)
- Committed: No (in .gitignore)
- Contents: Image files (.png/.jpg) generated by Gemini API + variants

**`research/` (generated, dc-due-diligence):**
- Purpose: Output folder for domain research reports during workflow
- Generated: Yes (created by orchestrator Phase 3)
- Committed: No (in .gitignore)
- Contents: 10 markdown report files (9 domain + 1 risk assessment)

**`.claude-plugin/` (committed):**
- Purpose: Plugin metadata for discovery and installation
- Generated: No (hand-maintained)
- Committed: Yes
- Contents: `marketplace.json` (root) and `plugin.json` (per-plugin)

---

*Structure analysis: 2026-02-23*
